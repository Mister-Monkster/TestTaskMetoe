# ☁️ Сайт для получения погоды
## Из ТЗ было выполнено

  1. **написаны тесты**
  
  2. **всё  помещено в докер контейнер**
  
  3. **при повторном посещении сайта будет предложено посмотреть погоду в городе, в котором пользователь уже смотрел ранее**
  
  4. **будет сохраняться история поиска для каждого пользователя, и будет API, показывающее сколько раз вводили какой город**
  
## Стек технологий 

1. **Web фреймворк - FastAPI**

2. **Работа с базой данных Postgresql - SQLAlchemy**

3. **Кэширование результатов для снижения нагрузки на БД - Redis**

4. **Обращение к сторонним API - requests**

## Руководство по запуску проекта

1.  **Клонируйте репозиторий:**
    Откройте терминал и клонируйте ваш проект:
    ```bash
    git clone [https://github.com/Mister-Monkster/TestMeteo.git](https://github.com/Mister-Monkster/TestMeteo.git)
    cd TestMeteo
    ```

2.  **Настройте переменные окружения:**
    Создайте файл `.env` в корневой директории вашего проекта, если его еще нет. Этот файл будет содержать важные конфигурационные данные.
    Пример содержимого `.env`:
    ```env
      DB_USER="Ваш пользователь"
      DB_PASSWORD="Ваш пароль"
      DB_HOST="Ваш хост"
      DB_PORT="Ваш порт"
      DB_NAME="Ваше имя ДБ"


    ```
   

3.  **Запустите все сервисы Docker Compose:**
    Эта команда соберет образ вашего FastAPI приложения, загрузит образы Redis и PostgreSQL, а затем запустит все контейнеры в фоновом режиме.
    ```bash
    docker-compose up --build -d
    ```
    * `--build`: Указывает Docker Compose пересобрать образ для сервиса `web` (ваше FastAPI приложение) перед запуском. Это необходимо при первом запуске, а также каждый раз, когда вы вносите изменения в `Dockerfile`, `requirements.txt` или в сам код приложения.
    * `-d`: Запускает контейнеры в "отсоединенном" (detached) режиме, позволяя вам продолжать использовать терминал.

4.  **Примените миграции базы данных Alembic:**
    После того как контейнеры запущены, необходимо применить миграции базы данных, чтобы создать необходимые таблицы и обновить схему. Эта команда выполняется внутри контейнера `web`.
    ```bash
    docker-compose exec web alembic upgrade head
    ```
    * `docker-compose exec web`: Выполняет команду внутри запущенного контейнера сервиса `web`.
    * `alembic upgrade head`: Команда Alembic для применения всех незавершенных миграций до самой последней версии.
5. **Загрузка данных в БД**: Для работы приложения необходимо импортировать данные из файла `weathercodes.csv` в таблицу `weather_codes`

Теперь ваше приложение FastAPI должно быть полностью запущено и доступно по адресу: `http://localhost:8000`.

### Запуск тестов

Для запуска тестов проекта используйте `pytest`.

